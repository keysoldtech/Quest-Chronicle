<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest & Chronicle - Multiplayer Prototype</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=MedievalSharp&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/style.css">
</head>
<body class="fantasy-bg">

    <!-- Lobby Screen: Visible on page load -->
    <div id="lobby" class="lobby-container">
        <h1 class="title-font">Quest & Chronicle</h1>
        <p class="subtitle-font">Multiplayer Prototype 3.41</p>
        
        <div class="input-group">
            <label for="playerName">Player Name</label>
            <input type="text" id="playerName" class="fantasy-input" placeholder="e.g., Elara the Brave">
        </div>
        
        <div id="game-mode-selector" class="input-group">
            <label>Game Mode</label>
            <div class="radio-group">
                <label class="radio-label">
                    <input type="radio" name="gameMode" value="Beginner" class="sr-only" checked>
                    <span>Beginner</span>
                </label>
                <label class="radio-label">
                    <input type="radio" name="gameMode" value="Advanced" class="sr-only">
                    <span>Advanced</span>
                </label>
            </div>
        </div>

        <div class="button-group">
            <button id="createRoomBtn" class="fantasy-button-primary">Create New Room</button>
            <div class="join-group">
                <input type="text" id="roomIdInput" class="fantasy-input" placeholder="Enter Room Code">
                <button id="joinRoomBtn" class="fantasy-button-secondary">Join Room</button>
            </div>
        </div>
    </div>

    <!-- Game Area: Hidden until a room is joined -->
    <div id="game-area" class="game-area hidden">
        <header class="game-header">
            <div>
                 <p id="turn-indicator" class="turn-indicator-font">Waiting for game to start...</p>
                 <p>Turn: <span id="turn-counter">0</span></p>
            </div>
             <div class="header-controls">
                <div id="dm-controls" class="dm-controls hidden">
                     <button id="dm-play-monster-btn" class="fantasy-button-sm fantasy-button-secondary">Play Monster</button>
                </div>
                <button id="join-voice-btn" class="fantasy-button-sm fantasy-button-success">Join Voice</button>
                <button id="startGameBtn" class="fantasy-button-primary hidden">Start Game</button>
                <div class="room-code-display">
                    <p>Room Code:</p>
                    <p id="room-code">----</p>
                </div>
            </div>
        </header>

        <main class="game-main">
            <!-- Left Column: Player List, Class Selection, Stats & Chat -->
            <aside class="left-panel">
                <div class="panel-box">
                    <h2 class="header-font">Players</h2>
                    <ul id="player-list" class="player-list"></ul>
                </div>

                <div id="class-selection" class="panel-box hidden">
                    <h2 class="header-font">Choose Your Class</h2>
                    <div id="class-cards-container" class="class-cards-container">
                        <!-- Class cards will be generated here -->
                    </div>
                    <div class="class-confirm-container">
                         <button id="confirm-class-btn" class="fantasy-button-primary hidden">Confirm Class</button>
                    </div>
                </div>
                
                <div id="advanced-card-choice" class="panel-box hidden">
                    <h2 class="header-font">Choose Starting Card</h2>
                    <div id="advanced-choice-buttons" class="class-buttons">
                        <!-- Advanced choice buttons will be generated here -->
                    </div>
                </div>

                <div id="player-stats-container" class="panel-box hidden">
                     <h2 class="header-font">Your Stats</h2>
                     <div id="player-stats" class="player-stats">
                         <!-- Stats will be rendered here -->
                     </div>
                </div>
                
                 <div class="panel-box chat-box">
                    <h2 class="header-font">Chat & Log</h2>
                    <div id="chat-log" class="chat-log"></div>
                    <form id="chat-form" class="chat-form">
                        <select id="chat-channel" class="fantasy-select">
                            <option value="game">Game</option>
                            <option value="party">Party</option>
                        </select>
                        <input type="text" id="chat-input" class="fantasy-input" placeholder="Type..." autocomplete="off">
                        <button type="submit" class="fantasy-button-sm fantasy-button-primary">Send</button>
                    </form>
                </div>
            </aside>

            <!-- Right Column: Game Board & Player Hand -->
            <div class="right-panel">
                <div class="world-events-section">
                     <h2 class="header-font">World Events</h2>
                     <div id="world-events-container" class="card-container-row"></div>
                </div>
                <div id="game-board" class="game-board-section">
                    <h2 class="header-font">Game Board</h2>
                    <div id="board-cards" class="card-container-row"></div>
                </div>
                <div class="player-hand-section">
                    <div class="player-hand-header">
                        <h2 class="header-font">Your Hand & Equipment</h2>
                        <div class="player-turn-controls">
                            <div id="player-actions-container" class="player-actions-container hidden">
                                <!-- Rest buttons will be added here by client.js -->
                            </div>
                            <button id="confirm-attack-btn" class="fantasy-button-primary hidden">Confirm Attack</button>
                            <button id="endTurnBtn" class="fantasy-button-danger hidden">End Turn</button>
                        </div>
                    </div>
                    
                    <div id="equipped-items-container" class="equipped-items-container">
                        <h3 class="sub-header-font">Equipped</h3>
                        <div id="equipped-items" class="card-container-row">
                            <!-- Equipped items will be rendered here -->
                        </div>
                    </div>
                    <div id="player-hand" class="player-hand-container card-container-row"></div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Narrative Input Modal -->
    <div id="narrative-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="header-font">Describe Your Action</h2>
            <p id="narrative-prompt">How do you use [Card Name]?</p>
            <textarea id="narrative-input" class="fantasy-input" rows="3" placeholder="e.g., I chant the arcane words and a bolt of fire erupts from my hands..."></textarea>
            <div class="modal-actions">
                <button id="narrative-cancel-btn" class="fantasy-button-secondary">Cancel</button>
                <button id="narrative-confirm-btn" class="fantasy-button-primary">Confirm</button>
            </div>
        </div>
    </div>

    <!-- "Your Turn" Popup -->
    <div id="your-turn-popup" class="your-turn-popup hidden">YOUR TURN</div>

    <!-- Dice Roll Overlay -->
    <div id="dice-roll-overlay" class="modal-overlay hidden">
        <div class="dice-roll-content">
            <h2 id="dice-roll-title" class="header-font">Attacking...</h2>
            <div class="dice-scene">
                <div id="attack-dice" class="dice">
                    <div class="face front"></div>
                    <div class="face back"></div>
                    <div class="face right"></div>
                    <div class="face left"></div>
                    <div class="face top"></div>
                    <div class="face bottom"></div>
                </div>
            </div>
            <div id="dice-roll-result" class="dice-roll-result-container hidden">
                <!-- Results will be populated here by JS -->
            </div>
        </div>
    </div>

    <!-- Event Overlay -->
    <div id="event-overlay" class="event-overlay hidden">
        <!-- Step 1: Roll Button -->
        <div id="event-roll-container" class="event-step-container">
            <h2 class="header-font">An Event is Triggered!</h2>
            <p>Your actions have drawn the attention of fate. Roll the dice to see what happens.</p>
            <button id="roll-dice-btn" class="fantasy-button-special">Roll Dice</button>
        </div>

        <!-- Step 2: Dice Animation -->
        <div id="event-dice-animation-container" class="event-step-container hidden">
            <div class="dice-scene">
                <div id="dice" class="dice">
                    <div class="face front"></div>
                    <div class="face back"></div>
                    <div class="face right"></div>
                    <div class="face left"></div>
                    <div class="face top"></div>
                    <div class="face bottom"></div>
                </div>
            </div>
        </div>

        <!-- Step 3: Result and Card Choice -->
        <div id="event-result-container" class="event-step-container hidden">
            <h2 class="header-font" id="event-result-title"></h2>
            <p id="event-result-subtitle"></p>
            <div id="event-card-selection" class="card-container-row hidden">
                <!-- Card backs will be generated here -->
            </div>
            <button id="event-result-okay-btn" class="fantasy-button-primary hidden">Okay</button>
        </div>
    </div>


    <!-- Container for remote audio streams -->
    <div id="voice-chat-container"></div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/client.js"></script>
</body>
</html>